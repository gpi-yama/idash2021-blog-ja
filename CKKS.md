# 準同型暗号で最先端のCKKSスキームを解説
### 円分整数
$\zeta = \exp(2\pi\sqrt{-1}/m)$とする。これは1のm乗根である($\zeta^m = 1$)。  

以下の式で定義される$\zeta$を根とする多項式を円分多項式という。

$$
\Phi_m(x) = \prod_{GCD(m,i) = 1} (x - \zeta^i)
$$

$n = \phi(m)$ として

$$
a_0 + a_1 \zeta + ... + a_{n-1} \zeta^{n-1}
$$

を円分整数(円のm分整数)という。  円(のm)分整数全体の集合を

$$
\Z[\zeta]/(\zeta^n + 1) = \{a_0 + a_1 \zeta + ... + a_{n-1} \zeta^{n-1} | a_0, a_1, ..., a_{n-1} \in \Z\}
$$

と表す。  

円分整数の係数は格子点($a_0, a_1, ..., a_{n-1}$)としてとらえることができ、円分整数hの大きさを格子点と対応づけて

$$
||h|| = \sqrt{a_0^2 + a_1^2 + ... + a_{n-1}^2}
$$

として表すことができる。  



### CKKSのエンコード・デコード
$z \in \mathbb{C} $を多項式 $m(X) \in \mathbb{C}[X] / (X^N+1)$にエンコードすることを考える。このために埋め込み $\sigma: \mathbb{C}[X] / (X^N + 1) \rightarrow \C^N$ を考える。  

埋め込みとは、環準同型の写像のことである。  

デコードから考えるとシンプルである。$m(X)$をベクトル$z$にデコードすることを考える場合、多項式を多項式環の根となる値で評価することを考えます。それらの根は、$\zeta, \zeta^3, ..., \zeta^{2N-1}$のN個の根となる。  

以上より、デコードは、  

$$
\sigma(m) = (m(\zeta), m(\zeta^3), ..., m(\zeta^{2N-1})}) \in \mathbb{C}^N
$$

として定義する。  
この写像は同型であるので、エンコードとして適切である。エンコード時はこれの逆写像を考えればよい。  




### CKKSの暗号化
